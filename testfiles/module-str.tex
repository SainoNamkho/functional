\documentclass{article}

\input{regression-test}
\AtBeginDocument{\START}
%\AtEndDocument{\END}

\usepackage{functional}
\Functional{tracing=true}

\begin{document}

\BEGINTEST{Testing \StrConst}
\StrConst \cFooSomeStr {12\abc34}
\StrUse \cFooSomeStr
\ENDTEST

\BEGINTEST{Testing \StrLog}
\StrLog {12\abc34}
\ENDTEST

\BEGINTEST{Testing \StrSet}
\StrSet \lTmpiStr {\IntMathMult{4}{5}}
\StrUse \lTmpiStr
\ENDTEST

\BEGINTEST{Testing \StrSetEq}
\StrSet \lTmpaStr {abc}
\StrSetEq \lTmpbStr \lTmpaStr
\StrUse \lTmpbStr
\ENDTEST

\BEGINTEST{Testing \StrClea}
\StrSet \lTmpjStr {One}
\StrClear \lTmpjStr
\StrSet \lTmpjStr {Two}
\StrUse \lTmpjStr
\ENDTEST

\BEGINTEST{Testing \StrClearNew}
\StrClearNew \lFooSomeStr
\StrUse \lFooSomeStr
\ENDTEST

\BEGINTEST{Testing \StrConcat}
\StrSet \lTmpbStr {con}
\StrSet \lTmpcStr {cat}
\StrConcat \lTmpaStr \lTmpbStr \lTmpcStr
\StrUse \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrPutLeft}
\StrSet \lTmpkStr {Functional}
\StrPutLeft \lTmpkStr {Hello}
\StrUse \lTmpkStr
\ENDTEST

\BEGINTEST{Testing \StrPutRight}
\StrSet \lTmpkStr {Functional}
\StrPutRight \lTmpkStr {World}
\StrUse \lTmpkStr
\ENDTEST

\BEGINTEST{Testing \StrVarReplaceOnce}
\StrSet \lTmpaStr {hello world}
\StrVarReplaceOnce \lTmpaStr {l} {-}
\StrUse \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrVarReplaceAll}
\StrSet \lTmpaStr {hello world}
\StrVarReplaceAll \lTmpaStr {l} {-}
\StrUse \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrVarRemoveOnce}
\StrSet \lTmpaStr {hello world}
\StrVarRemoveOnce \lTmpaStr {l}
\StrUse \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrVarRemoveAll}
\StrSet \lTmpaStr {hello world}
\StrVarRemoveAll \lTmpaStr {l}
\StrUse \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrCount}
\StrCount {12\abc34}
\StrSize {12\abc34}
\ENDTEST

\BEGINTEST{Testing \StrVarCount}
\StrSet \lTmpaStr {12\abc34}
\StrVarCount \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrHead}
\StrHead {HELLO}
\ENDTEST

\BEGINTEST{Testing \StrVarHead}
\StrSet \lTmpaStr {HELLO}
\StrVarHead \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrTail}
\StrTail {HELLO}
\StrLog {\StrTail {  a  {bc} d }}
\ENDTEST

\BEGINTEST{Testing \StrVarTail}
\StrSet \lTmpaStr {HELLO}
\StrVarTail \lTmpaStr
\ENDTEST

\BEGINTEST{Testing \StrItem}
\StrItem {abcd} {3}
\ENDTEST

\BEGINTEST{Testing \StrVarItem}
\StrSet \lTmpaStr {abcd}
\StrVarItem \lTmpaStr {3}
\ENDTEST

\BEGINTEST{Testing \StrMapInline}
\IgnoreSpacesOn
\StrClear \lTmpaStr
\StrMapInline {one} {
  \StrPutRight \lTmpaStr {[#1]}
}
\Return{\StrUse\lTmpaStr}
\IgnoreSpacesOff
\ENDTEST

\BEGINTEST{Testing \StrVarMapInline}
\IgnoreSpacesOn
\StrClear \lTmpaStr
\StrSet \lTmpkStr {one}
\StrVarMapInline \lTmpkStr {
  \StrPutRight \lTmpaStr {[#1]}
}
\Return{\StrUse\lTmpaStr}
\IgnoreSpacesOff
\ENDTEST

\BEGINTEST{Testing \StrMapVariable}
\IgnoreSpacesOn
\StrClear \lTmpaStr
\StrMapVariable {one} \lTmpiStr {
  \StrPutRight \lTmpaStr {\Expand {[\lTmpiStr]}}
}
\Return{\StrUse\lTmpaStr}
\IgnoreSpacesOff
\ENDTEST

\BEGINTEST{Testing \StrVarMapVariable}
\IgnoreSpacesOn
\StrClear \lTmpaStr
\StrSet \lTmpkStr {one}
\StrVarMapVariable \lTmpkStr \lTmpiStr {
  \StrPutRight \lTmpaStr {\Expand {[\lTmpiStr]}}
}
\Return{\StrUse\lTmpaStr}
\IgnoreSpacesOff
\ENDTEST

\BEGINTEST{Testing \StrIfExist}
\StrIfExistTF \lTmpaStr {\Return{Yes}} {\Return{No}}
\StrIfExistTF \lFooUndefinedStr {\Return{Yes}} {\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrVarIfEmpty}
\StrSet \lTmpaStr {abc}
\StrVarIfEmptyTF \lTmpaStr {\Return{Empty}} {\Return{NonEmpty}}
\StrClear \lTmpaStr
\StrVarIfEmptyTF \lTmpaStr {\Return{Empty}} {\Return{NonEmpty}}
\ENDTEST

\BEGINTEST{Testing \StrIfEq}
\StrIfEqTF {abc} {abc} {\Return{Yes}} {\Return{No}}
\StrIfEqTF {abc} {xyz} {\Return{Yes}} {\Return{No}}
\StrSet \lTmpaStr {abc}
\StrSet \lTmpbStr {abc}
\StrSet \lTmpcStr {xyz}
\StrIfEqTF {\lTmpaStr} {\lTmpbStr} {\Return{Yes}} {\Return{No}}
\StrIfEqTF {\lTmpaStr} {\lTmpcStr} {\Return{Yes}} {\Return{No}}
\StrIfEqTF {\Value\lTmpaStr} {\Value\lTmpbStr} {\Return{Yes}} {\Return{No}}
\StrIfEqTF {\Value\lTmpaStr} {\Value\lTmpcStr} {\Return{Yes}} {\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrVarIfEq}
\StrSet \lTmpaStr {abc}
\StrSet \lTmpbStr {abc}
\StrSet \lTmpcStr {xyz}
\StrVarIfEqTF \lTmpaStr \lTmpbStr {\Return{Yes}} {\Return{No}}
\StrVarIfEqTF \lTmpaStr \lTmpcStr {\Return{Yes}} {\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrIfIn}
\StrIfInTF {hello world} {o} {\Return{Yes}}{\Return{No}}
\StrIfInTF {hello world} {a} {\Return{Yes}}{\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrVarIfIn}
\StrSet \lTmpaStr {hello world}
\StrVarIfInTF \lTmpaStr {o} {\Return{Yes}}{\Return{No}}
\StrVarIfInTF \lTmpaStr {a} {\Return{Yes}}{\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrCompare}
\BoolVarLog {\StrCompare {ab} < {abc}}
\BoolVarLog {\StrCompare {ab} < {aa}}
\StrCompareTF {ab} < {abc} {\Return{Yes}} {\Return{No}}
\StrCompareTF {ab} < {aa} {\Return{Yes}} {\Return{No}}
\BoolVarLog {\StrIfCompare {ab} < {abc}}
\BoolVarLog {\StrIfCompare {ab} < {aa}}
\StrIfCompareTF {ab} < {abc} {\Return{Yes}} {\Return{No}}
\StrIfCompareTF {ab} < {aa} {\Return{Yes}} {\Return{No}}
\ENDTEST

\BEGINTEST{Testing \StrCaseF}
\IgnoreSpacesOn
\StrCaseF {bbb} {
  {aaa} { \TlSet\lTmpkTl{First} }
  {bbb} { \TlSet\lTmpkTl{Second} }
  {ccb} { \TlSet\lTmpkTl{Third} }
}{
  \Return {No Match!}
}
\Return {\TlUse\lTmpkTl}
\IgnoreSpacesOff
\ENDTEST

\BEGINTEST{Testing \StrCaseTF}
\IgnoreSpacesOn
\StrCaseTF {ddd} {
  {aaa} { \TlSet\lTmpkTl{First} }
  {bbb} { \TlSet\lTmpkTl{Second} }
  {ccb} { \TlSet\lTmpkTl{Third} }
}{
  \Return {\TlUse\lTmpkTl}
}{
  \Return {No ~ Match!}
}
\IgnoreSpacesOff
\ENDTEST

\end{document}
