%  -*- coding: utf-8 -*-

\documentclass{article}

\usepackage{functional}

\Functional{scoping=false,tracing=true}

\begin{document}

\ExplSyntaxOn

\tl_new:N \lTmpaTl
\tl_new:N \lTmpbTl
\tl_new:N \lTmpcTl
\cs_set_eq:NN \TlSet \tl_set:Nn
\cs_set_eq:NN \TlGset \tl_gset:Nn

\PrgNewFunction \IntMathSquare { m }
  {
    \int_set:Nn \l_tmpa_int { \int_eval:n { #1 * #1 } }
    \ExpResult { \int_use:N \l_tmpa_int }
  }

\PrgNewFunction \IntMathAdd { m m }
  {
    \int_set:Nn \l_tmpa_int { \int_eval:n { #1 + #2 } }
    \ExpResult { \int_use:N \l_tmpa_int }
  }

\PrgNewFunction \IntMathSubtract { m m }
  {
    \int_set:Nn \l_tmpa_int { \int_eval:n { #1 - #2 } }
    \ExpResult { \int_use:N \l_tmpa_int }
  }

\PrgNewFunction \IntMathMultiply { m m }
  {
    \int_set:Nn \l_tmpa_int { \int_eval:n { #1 * #2 } }
    \ExpResult { \int_use:N \l_tmpa_int }
  }

\PrgNewFunction \IntMathDivide { m m }
  {
    \int_set:Nn \l_tmpa_int { \int_eval:n { #1 / #2 } }
    \ExpResult { \int_use:N \l_tmpa_int }
  }

\PrgNewFunction \UseOne { n }
  {
    \Result { #1 }
  }

\PrgNewFunction \GobbleOne { n }
  {
    \Result { }
  }

\PrgNewFunction \UseFirstOfTwo { n n }
  {
    \GobbleOne { #2 } \UseOne { #1 }
  }

\PrgNewFunction \UseSecondOfTwo { n n }
  {
    \GobbleOne { #1 } \UseOne { #2 }
  }

\PrgNewConditional \BoolIf { N }
  {
    \Result { #1 }
  }

\PrgNewFunction \TlIfEqTF { N N }
  {
    \tl_if_eq:NNTF #1 #2
      { \Result { \UseFirstOfTwo } }
      { \Result { \UseSecondOfTwo } }
  }

\PrgNewFunction \IntCompareTF { m N m }
  {
    \int_compare:nNnTF {#1} #2 {#3}
      { \Result { \UseFirstOfTwo } }
      { \Result { \UseSecondOfTwo } }
  }

\ExplSyntaxOff

\IntMathSquare{5}

\IntMathAdd{7}{3}
\IntMathSubtract{7}{3}
\IntMathMultiply{7}{3}
\IntMathDivide{7}{3}

\IntMathSquare{\IntMathSquare{5}}

\GobbleOne{abc} \UseOne{uvw}

\UseFirstOfTwo{abc}{uvw} \UseSecondOfTwo{abc}{uvw}

\BoolIfTF\cTrueBool{\Result{true}}{\Result{false}}
\BoolIfTF\cFalseBool{\Result{true}}{\Result{false}}

\TlSet{\lTmpaTl}{abc}
\TlSet{\lTmpbTl}{abc}
\TlSet{\lTmpcTl}{xyz}
\TlIfEqTF{\lTmpaTl}{\lTmpbTl}{first}{second}
\TlIfEqTF{\lTmpaTl}{\lTmpcTl}{first}{second}

\IntCompareTF{2}>{1}{first}{second}
\IntCompareTF{2}>{3}{first}{second}

\end{document}

